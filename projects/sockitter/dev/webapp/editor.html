<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Sockitter Manager</title>

    <script src="jquery-3.3.1.min.js"></script>
    <script>
    $.ajaxSetup({ traditional: true });

    var ds_name = 'tweets';

    function update() {
      var screen_names = $('#screen_names').val().split('\n');
      $.ajax({
        type: "POST", async: false,
        url: 'api/follow',
        data: jQuery.param({"ds_name": ds_name, "screen_name": screen_names}, true),

        success: function (data) {
          console.log(data);
        },

        fail: function( xhr, status, errorThrown ) {
          alert(errorThrown);
        }
      });
    }

    function load() {
      $.ajax({
        type: "GET", async: false,
        url: 'api/follow',
        data: jQuery.param({"ds_name": ds_name}, true),

        success: function (data) {
          console.log(data);
          $('#screen_names').val(data.screen_names ? data.screen_names.join('\n') : '');
        },

        fail: function( xhr, status, errorThrown ) {
          alert(errorThrown);
        }
      });

    }

    $(function() {
      console.log(window.location);
      load();
     });
    </script>
</head>
<body>

<form action="#" method="POST" onsubmit="update(); return false;">

    Screen Names:
        <textarea id="screen_names" rows="20" cols="30">

        </textarea>

    <input type="submit"/>
</form>


</body>
</html>
