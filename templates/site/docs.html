{% import "macros.html" as macros %}
{% extends base_layout %}

{% block title %}Docs :: {% endblock %}

{% block page_styles %}
{% endblock %}

{% block description %}You found the docs!{% endblock %}

{% block cards %}
    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@lucidworks" />
    <meta name="twitter:title" content="Lucidworks Labs Docs" />
    <meta name="twitter:description" content="Lucidworks Labs documentation pages. Go here for help." />
    <meta name="twitter:image" content="https://lucidworks.com/wp-content/uploads/2018/06/Fusion4-Blog-Header-NoText-1200x420.jpg" />
{% endblock %}

{% block navbar %}
  {% include 'navbar.html' %}
{% endblock %}

{% block content %}
<!-- hidden delete modal -->
<div id="delete" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 data-toc-skip="true" class="modal-title" id="myModalLabel">Confirm Internet Deletion</h4>
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete the Internet?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-default" data-dismiss="modal">Close</button>
        <button type="button" id="delete-button" class="btn btn-outline-danger">Delete Internet</button>
      </div>
    </div>
  </div>
</div>
<div class="inverse">
  <div class="container">
    <div class="row">
      <h1>Labs Documentation</h1>
    </div>
    <div class="row"
      <p class="blurb">That brain of mine is something more than merely mortal; as time will show. &nbsp;  <span class="source">Ada Lovelace</span></p>
    </div>
  </div>
</div>
<div id="docs">
  <div class="row">
    <!--Main Content -->
    <div class="col-8">
      <section id="getting-started" class="group">
        <h3>Getting Started</h3>
        <p>This page contains documention for <a href="https://lucidworks.com/labs">Lucidwork's Labs</a>, which has been designed to enable quick evalution of Lucidwork Fusion and its various applications. Documentation for Lucidworks Fusion is located <a href="https://doc.lucidworks.com/">here</a>.</p>
        <p>The <a href="https://github.com/lucidworks/streams/">Lucidworks Streams Repo</a> on Github contains additional code, scripts, instructions and video guides to help you get started using Fusion quickly.</p>
        <p>If you are looking to download the Fusion binary, please visit the <a href="https://lucidworks.com/download/">Fusion Download page</a>.</p>

        <div id="github-auth" class="subgroup">
          <h4>Github Authentication</h4>
          <p>Lucidworks Labs uses your Github account for authentication. The first time you navigate to any of the instance pages hosted on the <strong>streams.lucidworks.com</strong> subdomain, you will be redirected to Github and prompted for <strong>read permissions</strong> on your Github user profile.</p>
          <p><img src="/img/github.png"></p>
          <p>To authenticate now, click on the <strong>Launch Instance</strong> button in the next section.</p>
        </div>
        
        <div id="quickstart" class="subgroup">
          <h4>Quickstart an Instance</h4>
          <p>Lucidworks Labs allows you to launch demo Fusion instances with a single click. Try it now:</p>
          <p><button id="instance-demo" class="btn btn-outline-info"><span class="fa fa-play"></span> Launch Instance</button></p>
        </div>

        <div id="profile" class="subgroup">
          <h4>Update Your Profile</h4>
          <p>Your Lucidworks Labs account settings may be updated by navigating to the <a href="https://streams.lucidworks.com/settings/">Account Settings</a> page.</p>
          <p><img src="/img/accountsettingssmall.png"></p>
        </div>

        <div id="2fa" class="subgroup">
          <h4>Two Factor Authentication</h4>
          <p>To enable 2FA, click on the on/off slider at the top of your setting page and then use Google Authenticator to scan the QR code on the screen.</p>
          <p><img src="/img/2fasetupsmall.png"></p>
        </div>

        <div id="2fa" class="subgroup">
          <h4>Unlink Account</h4>
          <p>To revoke the Lucidworks Labs application from your Github account, navigate to your Github Applications list and click on the revoke button next to the Lucidworks Labs application.</p>
          <p><img src="/img/githubrevoke.png"></p>
        </div>

      </section>

      <section id="instances" class="group">
        <h3>Instances</h3>
        <p>Instances may be created directly from your <a href="/instances">instances page</a>, by visiting the various application templates on the <a href="https://lucidworks.com/labs">Labs main page</a> or using the APIs below. Once a Fusion instance has been created for you, the Fusion admin UI will be accessable from the instance's IP address and a set of credentials created for the instance.</p>
        <p>A sample URI format used to access the Fusion admin UI:</p>
        <pre>http://35.185.228.240:8764/admin/login</pre>

        <div id="instance-starting" class="subgroup">
          <h4>Creating & Naming</h4>
          <p>To create a Fusion instance from your <a href="/instances">instances page</a>, click on the <strong>Create Instance</strong> button and then select a Fusion template to use to start the instance. The time for startup and provisioning takes about 5-8 minutes, but sometimes can be instant if there are hotstarts available to assign.</p>
          <p><img src="/img/createinstance.png"></p>
          <p>If you are looking to start an empty, vanilla instance of Fusion use the <strong><a href="https://streams.lucidworks.com/instance/create/starter412">Fusion 4.1.2</a></strong> template.</p>
          <p>To name an instance to something more useful, navigate to its detail page and then click on the name at the top. Type in a new name and then hit enter to save.</p>
          <p><img src="/img/renameinstance.png"></p>
          <p>To revert the instance name to the one used at provisioning time, delete the entire name and hit enter.</p>
        </div>
        
        <div id="instance-credentials" class="subgroup">
          <h4>Credentials & Admin UI</h4>
          <p>Once a Fusion instance is running, the credentials to login to the instance will be shown, along with the IP address of the instance.</p>
          <p><img src="/img/instanceaccess.png"></p>
          <p>You may access Fusion's <strong>admin interface</strong> for the instance by using the <strong>Click to Login</strong> button. You'll login with the credentials provided above, which is located on the <strong>instance detail page</strong>.</p>
          <p><img src="/img/fusionlogin.png"></p>
        </div>

        <div id="instance-timers" class="subgroup">
          <h4>Timers</h4>
          <p>Fusion instances started on Labs have both <strong>run and life timers</strong>. If an instance's <strong>run timer</strong> runs out, it will be stopped and halted. If an instance's <strong>life timer</strong> reaches zero, it will be permanently deleted regardless of whether or not it is running.</p>
          <p><img src="/img/timers2.png"></p>
          <div class="bs-callout bs-callout-warning bs-callout-top">
            <h4>Note on Preemption</h4>
            <p>Instances may be occasionally preempted and stopped before their <strong>run timer</strong> expires. If one of your instances is stopped early, simply start it again by clicking on the start button.</p>
          </div>

        </div>

        <div id="instance-deleting" class="subgroup">
          <h4>Deletion</h4>
          <p>Once you are finished with an instance, you may delete it from your <a href="/instances">list of instances</a> by clicking on its <button id="delete-internet" type="button" class="btn btn-outline-danger btn-sm" title="Delete Instance" href="#"><span class="fa fa-remove"></span></button> button.</p>
          <p>You may also delete the instance from its detail view. To delete an instance, click on the <strong>Delete Instance</strong> button at the bottom of the page and then click <strong>Delete Instance</strong> again in the confirmation dialog that pops up.</p>
          <p><img src="/img/delete2.png"></p>
        </div>
      </section>

      <section id="applications" class="group">
        <h3>Applications</h3>
        <p>Fusion applications combine configuration specific parameters with an optional user interface. Applications can be a simple as <strong>data source</strong> using a <strong>web connector</strong> with a few <strong>start links</strong>.</p>
        <p>Depending on complexity, Fusion applications may or may not include an <strong>application link</strong> once the instance is running. When a Fusion application supports it, a link to the application's UI will become available from the instance detail page:</p>
        <p><img src="/img/applink.png"></p>

        <div id="application-templates" class="subgroup">
          <h4>Templates</h4>
          <p>Application templates are managed by Lucidworks. Templates include an application zip file and a simple installation script which configures the instance with the application and any required data and or setup.</p>
          <p>You may <a href="https://github.com/lucidworks/streams/tree/master/projects/apps">view the example application templates on Github</a>.</p>
          <p>A complete list of templates and their accompanying instructions and/or repositories are available over on the <a href="https://lucidworks.com/labs">Labs index page</a>.</p>
        </div>
        
        <div id="application-starting" class="subgroup">
          <h4>Creating</h4>
          <p>To create a Fusion application instance, navigate to the <a href="https://lucidworks.com/labs">Labs index page</a> and click on the the application you'd like to start. Once the application detail page loads, click on the <strong>Launch Instance</strong> button to create and start the application's instance.</p>
          <p><img src="/img/fusionstarter.png"></p>
        </div>

        <div id="application-restart" class="subgroup">
          <h4>Starting Stopped Instances</h4>
          <p>To start a stopped/preempted Fusion instance, navigate to the <a href="https://streams.lucidworks.com/instances">instances page</a> and click on the the <button type="button" id="start" class="btn btn-outline-info btn-sm" title="Start Instance" href="#"><span class="fa fa-play"></span></button> button next to the instance you'd like to start. You can also start a stopped instance from its detail view.</p>
          <p>At this time there is no feature to allow for the restart of an already running instance.</p>
        </div>

      </section>

      <section id="apis" class="group">
        <h3>REST APIs</h3>
        <p>Lucidworks Labs provides a few basic API methods to start, monitor and access your instances programmatically.</p>
        <p>API calls are made to the following subdomain:</p>
        <pre>streams.lucidworks.com</pre>

        <div id="api-token" class="subgroup">
          <h4>API Tokens</h4>
          <p>API tokens may be obtained by navigating to your <a href="{{ uri_for('account-settings') }}">settings page</a> and then clicking on the <strong>Generate API Token</strong> button.</p>
        </div>

        <div id="api-status" class="subgroup">
          <h4>Status Methods</h4>
          <h5>API Status</h5>
          <p>Status of the system running the API may be retrieved by making a <strong>GET</strong> request to the endpoint:</p>
          <p><strong>streams.lucidworks.com/api/status</strong></p>
          <p>This method takes one parameter:</p>
          <ul>
            <li><strong>token=&lt;dev_token&gt;</strong> - a developer token</li>
          </ul>

<pre>
curl https://streams.lucidworks.com/api/status?token=qnSNLUQF8YzRjiizDr8J0Ba8z2FBXtfTbYByGoDHsWsXhMwpFLvlUyg7ASFvo13a
{ 
  'response': "ok",
  'result': {
    'message': "system is operating normally",
    'starts_last_five_minutes': 2,
    'confidence': 0.5
  }
}
</pre>
        </div>



        <div id="api-templates-list" class="subgroup">
          <h4>Template Methods</h4>
          <p>Template streams are used to launch a specific application running on Fusion.</p>
          <p>Calls to the <strong>template</strong> endpoints require a <strong>token</strong> parameter be included.</p>
          <h5>List</h5>
          <p>A list of templates is returned by making a <strong>GET</strong> request to the endpoint:</p>
          <p><strong>streams.lucidworks.com/api/template/list</strong></p>
          <p>This method takes one parameter:</p>
          <ul>
            <li><strong>token=&lt;dev_token&gt;</strong> - a developer token</li>
          </ul>
<pre>
curl https://streams.lucidworks.com/api/template/list?token=qnSNLUQF8YzRjiizDr8J0Ba8z2FBXtfTbYByGoDHsWsXhMwpFLvlUyg7ASFvo13a
{ 
  [
    {
      "description": "A starter template for Fusion 4.0.2.",
      "name": "Fusion Starter 4.0.2",
      "sid": "starter",
      "api_stub": "/api/template/starter"
    },
    {
      "description": "May I help you?",
      "name": "Lou for Fusion 4.1.1",
      "sid": "lou",
      "api_stub": "/api/template/lou"
    }
  ]
}
</pre>
        </div>
        <div id="api-templates-status" class="subgroup">
          <h5>Template</h5>
          <p>Template information may be retrieved by making a <strong>GET</strong> request to the endpoint:</p>
          <p><strong>streams.lucidworks.com/api/template/&lt;template-id&gt;</strong></p>
          <p>This method takes one parameter:</p>
          <ul>
            <li><strong>token=&lt;dev_token&gt;</strong> - a developer token</li>
          </ul>
<pre>
curl https://streams.lucidworks.com/api/template/lou?token=qnSNLUQF8YzRjiizDr8J0Ba8z2FBXtfTbYByGoDHsWsXhMwpFLvlUyg7ASFvo13a
{
  "created": "2018-08-17 17:37:29.827000",
  "updated": "2018-08-17 17:37:29.827000",
  "sid": "lou",
  "name": "Lou for Fusion 4.1.1",
  "description": "May I help you?",
  "distro": "lou-buttons.tgz",
  "fusion_version": "4.1.1",
  "github_repo": "",
  "app_stub": ":8764/webapps/lou-demo/",
  "labs_link": "https://lucidworks.com/labs/apps/lou"
}
</pre>
        </div>
        <div id="api-instance-list" class="subgroup">
          <h4>Instance Methods</h4>
          <p>Calls to the <strong>instance</strong> endpoints require a <strong>token</strong> parameter be included.</p>
          <h5>List</h5>
          <p>A list of instances which the token controls can be retrieved by making a <strong>GET</strong> request to the endpoint:</p>
          <p><strong>streams.lucidworks.com/api/instance/list</strong></p>
          <p>This method takes one parameter:</p>
          <ul>
            <li><strong>token=&lt;dev_token&gt;</strong> - a developer token</li>
          </ul>
<pre>
curl https://streams.lucidworks.com/api/instance/list?token=qnSNLUQF8YzRjiizDr8J0Ba8z2FBXtfTbYByGoDHsWsXhMwpFLvlUyg7ASFvo13a"
{ 
  [
    {
      'name': "button-lou-8uvx1b",
      "status": "PROVISIONING",
      'status_stub': "/api/instance/button-lou-8uvx1b"
    },
    {
      "name": "button-activate-ja9w1c",
      "status": "RUNNING",
      "api_stub": "/api/instance/button-activate-ja9w1c"
    }
  ]
}
</pre>
          <h5>Info</h5>
          <p>Instance info may be retrieved by making a <strong>GET</strong> request to the endpoint:</p>
          <p><strong>streams.lucidworks.com/api/instance/&lt;instance-name&gt;</strong></p>
          <p>This method takes one parameter:</p>
          <ul>
            <li><strong>token=&lt;dev_token&gt;</strong> - a developer token</li>
          </ul>
<pre>
curl https://streams.lucidworks.com/api/instance/button-activate-8uvx1b?token=qnSNLUQF8YzRjiizDr8J0Ba8z2FBXtfTbYByGoDHsWsXhMwpFLvlUyg7ASFvo13a
{ 
  "created": "2019-01-02 00:54:02.610331",
  "updated": "2019-01-02 01:07:05.034839",
  "started": "2019-01-02 00:54:02.610158",
  "expires": "2019-01-09 00:54:02.610139",
  "sid": "activate",
  "name": "button-activate-ja9w1c",
  "topic": "ai",
  "region": "any",
  "preemptible": True,
  "ip": "35.230.80.39",
  "admin_link": "http://35.230.80.39:8764",
  "app_link": "http://35.230.80.39:8764/webapps/Lucidworks_Search_UI/",
  "password": "69nm5pxgaj56",
  "status": "RUNNING",
  "username": "kordless",
  "template": "activate"
}
</pre>
        </div>
        <div id="api-instance-create" class="subgroup">
          <h5>Create</h5>
          <p>Instances may be created and started by making a <strong>POST</strong> request to the Stream endpoint:</p>
          <p><strong>streams.lucidworks.com/api/stream/&lt;template-name&gt;</strong></p>
          <p>This method takes several parameters:</p>
          <ul>
            <li><strong>token=&lt;dev_token&gt;</strong> - a developer token</li>
            <li><strong>preemptible=&lt;false|0&gt;</strong> - request non-preemptible instance</li>
            <li><strong>topic=&lt;topic&gt;</strong> - topic of interest matching [a-z0-9]</li>
            <li><strong>region=&lt;region&gt;</strong> - region by integer in which to start instance</li>
          </ul>
          <p>Integer values for <a href="https://cloud.google.com/compute/docs/regions-zones/">Google regions:</a></p>
          <ul>
            <li>0 - us-central1</li>
            <li>1 - us-west1</li>
            <li>2 - us-west2</li>
            <li>3 - us-east4</li>
            <li>4 - us-east1</li>
            <li>5 - europe-west2</li>
            <li>6 - asia-east2</li>
          </ul>
          <p>This method requires the <code>Content-length</code> header be set to <code>0</code> in the request.</p>
<pre>
curl -X POST \
-d 'Content-length: 0' \
"https://streams.lucidworks.com/api/stream/starter41?token=qnSNLUQF8YzRjiizDr8J0Ba8z2FBXtfTbYByGoDHsWsXhMwpFLvlUyg7ASFvo13a&preemptible=0&topic=space"
{ 
  "created": "2019-01-02 01:10:47.578490",
  "updated": "2019-01-02 01:10:47.578501",
  "started": "2019-01-02 01:10:47.578179",
  "expires": "2019-01-09 01:10:47.578157",
  "sid": "lou",
  "name": "button-lou-80543c",
  "topic": "space",
  "region": "any",
  "preemptible": False,
  "ip": "None",
  "admin_link": "None",
  "app_link": "None",
  "password": "6b71nhejs463",
  "status": "PROVISIONING",
  "username": "kordless",
  "template": "lou"
}
</pre>
        </div>
        <div id="api-instance-start" class="subgroup">
          <h5>Start</h5>
          <p>Instances with status <code>TERMINATED</code> were preempted and may be restarted by making a <strong>GET</strong> request to the endpoint:</p>
          <p><strong>streams.lucidworks.com/api/instance/&lt;instance-name&gt;/start</strong></p>
          <p>This method takes one parameter:</p>
          <ul>
            <li><strong>token=&lt;dev_token&gt;</strong> - a developer token</li>
          </ul>
<pre>
curl https://streams.lucidworks.com/api/instance/button-starter41-8uvx/start?token=qnSNLUQF8YzRjiizDr8J0Ba8z2FBXtfTbYByGoDHsWsXhMwpFLvlUyg7ASFvo13a
{
  "created": "2018-12-14 01:51:29.417217",
  "updated": "2018-12-17 23:33:41.297202",
  "started": "2018-12-17 23:33:41.293804",
  "expires": "2018-12-21 01:51:29.416775",
  "sid": "starter41",
  "name": "button-lou-ehhd2a",
  "topic": "ai",
  "region": "any",
  "preemptible": True,
  "ip": "None",
  "admin_link": "None",
  "app_link": "None",
  "username": "admin",
  "password": "ntamgl2afdsp",
  "status": "PROVISIONING",
  "username": "kordless",
  "template": "starter41"
}
</pre>
        </div>

        <div id="api-instance-status" class="subgroup">
          <h5>Status</h5>
          <p>The status of an instance may be updated from itself by using the instance's password. Instances status update is performed uising a <strong>GET</strong> on the <strong>status</strong> endpoint:</p>
          <p><strong>streams.lucidworks.com/api/instance/&lt;instance-name&gt;/status</strong></p>
          <p>This method takes two parameters:</p>
          <ul>
            <li><strong>password=&lt;instance_passwords&gt;</strong> - the instance password</li>
            <li><strong>status=&lt;instance_status_string&gt;</strong> - one status of PROVISIONING, STAGING, CONFIGURING, RUNNING, STOPPING, TERMINATED</li>
          </ul>
<pre>
curl https://streams.lucidworks.com/api/instance/button-starter41-8uvx/status?password=ntamgl2afdsp&status=RUNNING
  "created": "2018-12-14 01:51:29.417217",
  "updated": "2018-12-17 23:33:41.297202",
  "started": "2018-12-17 23:33:41.293804",
  "expires": "2018-12-21 01:51:29.416775",
  "sid": "starter41",
  "name": "button-starter41-ehhd2a",
  "topic": "ai",
  "region": "any",
  "preemptible": True,
  "ip": "None",
  "admin_link": "None",
  "app_link": "None",
  "username": "admin",
  "password": "ntamgl2afdsp",
  "status": "RUNNING",
  "username": "kordless",
  "template": "starter41"
}
</pre>
        </div>
        <p>More API methods coming soon!</p>
      </section>
    </div>
    
    <!--TOC-->
    <div class="col-2">
      <nav id="toc"class="sticky-top">
        
      </nav>
    </div>
  </div>
</div>
{% endblock %}

{% block footer %}
<div class="footer-strip">
  <div class="container">
    <div class="row">
    </div>
  </div>
</div>
{% include 'footer.html' %}
{% endblock %}

{% block javascript %}
  <script type="text/javascript">
    $().ready(function() {

      $('#delete-internet').click( function() {
        $('#delete').modal();
      });

      $('#delete-button').click(function() {
        $('#delete').modal('hide');
        alertify.success("Internet deleted!");
      });

      $('#instance-demo').click(function() {
        var url = "https://streams.lucidworks.com/instance/create/ecommerce";
        $("<a>").attr("href", url).attr("target", "_blank")[0].click(); 
      });

      $(function() {
        var navSelector = "#toc";
        var $myNav = $(navSelector);
        Toc.init($myNav, $("h3","h4","h5"));
        $("body").scrollspy({
          target: navSelector
        });
      });

    });
  </script>
{% endblock %}